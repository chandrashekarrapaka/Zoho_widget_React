{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{Pie}from\"react-chartjs-2\";import{Velocity}from\"../../../Services/Velocity\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Machine(prop){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showPopup=_useState2[0],setShowPopup=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),apiData=_useState4[0],setApiData=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),board=_useState6[0],setBoard=_useState6[1];//insta=true\nuseEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Velocity();case 3:response=_context.sent;setApiData(response);// Update state with API data\n_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();// Fetch API data every 30 seconds\nvar interval=setInterval(fetchData,30000);return function(){return clearInterval(interval);};},[]);useEffect(function(){console.log(\"chandu\");setBoard(!board);},[prop.board]);var getChartData=function getChartData(machine){// const monitors = machine.monitors.length;\n//console.log(machine.monitors);\nvar healthScores=machine.monitors.map(function(monitor){return monitor.status;}).filter(function(healthScore){return healthScore!==undefined;});var healthScorePercentages=[healthScores.filter(function(score){return score==5;}).length,healthScores.filter(function(score){return score==4;}).length,healthScores.filter(function(score){return score==3;}).length,healthScores.filter(function(score){return score==2||score==1;}).length];return{// labels: ['Healthy', 'Warning', 'Critical', 'Undefined'],\ndatasets:[{data:healthScorePercentages,backgroundColor:['#64DD17','#FFC107','#FF5722','#9E9E9E']}],options:{legend:{display:false}}};};var getChartData2=function getChartData2(machine){// const monitors = machine.monitors.length;\n//console.log(machine.monitors);\nvar healthScores=machine.monitors.map(function(monitor){return monitor.healthScore;}).filter(function(healthScore){return healthScore!==undefined;});var healthScorePercentages=[healthScores.filter(function(score){return score<=100&&score>80;}).length,healthScores.filter(function(score){return score<=80&&score>50;}).length,healthScores.filter(function(score){return score<=50&&score>0;}).length,healthScores.filter(function(score){return score==0;}).length];return{// labels: ['Healthy', 'Warning', 'Critical', 'Undefined'],\ndatasets:[{data:healthScorePercentages,backgroundColor:['#64DD17','#FFC107','#FF5722','#9E9E9E']}],options:{legend:{display:false}}};};return/*#__PURE__*/_jsx(\"div\",{className:\"cement-mill-sec\",children:/*#__PURE__*/_jsx(\"div\",{className:\"cement-mill-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[prop.machine.map(function(machine,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg col-20 mb-1\",children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:\"bold\"},children:machine.name}),board?/*#__PURE__*/_jsx(Pie,{data:getChartData(machine),width:200,height:200,options:{maintainAspectRatio:false,responsive:false}}):/*#__PURE__*/_jsx(Pie,{data:getChartData2(machine),width:200,height:200,options:{maintainAspectRatio:false,responsive:false}}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Health Score: \"+machine.healthScore,/*#__PURE__*/_jsx(\"br\",{}),\"Status: \"+machine.status,/*#__PURE__*/_jsx(\"br\",{}),\"MG: \"+machine.mg]})]},index);}),showPopup&&/*#__PURE__*/_jsx(\"div\",{className:\"popup\",id:\"exampleModal\",tabIndex:\"-1\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\"})]})})});}export default Machine;","map":{"version":3,"names":["React","useState","useEffect","Pie","Velocity","jsx","_jsx","jsxs","_jsxs","Machine","prop","_useState","_useState2","_slicedToArray","showPopup","setShowPopup","_useState3","_useState4","apiData","setApiData","_useState5","_useState6","board","setBoard","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","sent","t0","console","log","stop","apply","arguments","interval","setInterval","clearInterval","getChartData","machine","healthScores","monitors","map","monitor","status","filter","healthScore","undefined","healthScorePercentages","score","length","datasets","data","backgroundColor","options","legend","display","getChartData2","className","children","index","style","fontWeight","name","width","height","maintainAspectRatio","responsive","mg","id","tabIndex"],"sources":["C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/src/Components/Containers/Plant/Machine.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Pie } from \"react-chartjs-2\";\r\nimport { Velocity } from \"../../../Services/Velocity\";\r\n\r\nfunction Machine(prop) {\r\n  const [showPopup, setShowPopup] = useState(false);\r\n  const [apiData, setApiData] = useState([]);\r\n  const [board,setBoard]=useState(true);//insta=true\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await Velocity();\r\n        setApiData(response); // Update state with API data\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n\r\n    // Fetch API data every 30 seconds\r\n    const interval = setInterval(fetchData, 30000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log(\"chandu\");\r\n   \r\n    setBoard(!board);\r\n  }, [prop.board]);\r\n  const getChartData = (machine) => {\r\n    // const monitors = machine.monitors.length;\r\n    //console.log(machine.monitors);\r\n    \r\n    const healthScores = machine.monitors\r\n    .map((monitor) => monitor.status)\r\n    .filter((healthScore) => healthScore !== undefined);\r\n\r\n    const healthScorePercentages = [\r\n      healthScores.filter((score) => score == 5 ).length,\r\n      healthScores.filter((score) => score == 4).length,\r\n      healthScores.filter((score) => score == 3).length,\r\n      healthScores.filter((score) => score == 2 ||score == 1).length,\r\n    ];\r\n   \r\n\r\n    return {\r\n      // labels: ['Healthy', 'Warning', 'Critical', 'Undefined'],\r\n      datasets: [\r\n        {\r\n          data: healthScorePercentages,\r\n          backgroundColor: ['#64DD17', '#FFC107', '#FF5722', '#9E9E9E'],\r\n        },\r\n      ],\r\n      options: {\r\n        legend: {\r\n          display: false,\r\n        },\r\n      },\r\n    };\r\n  };\r\n  const getChartData2 = (machine) => {\r\n    // const monitors = machine.monitors.length;\r\n\r\n    //console.log(machine.monitors);\r\n      const healthScores = machine.monitors\r\n      .map((monitor) => monitor.healthScore)\r\n      .filter((healthScore) => healthScore !== undefined);\r\n\r\n    const healthScorePercentages = [\r\n      healthScores.filter((score) => score <= 100 &&score > 80).length,\r\n      healthScores.filter((score) => score <=80  &&score > 50).length,\r\n      healthScores.filter((score) => score <=50  &&score > 0).length,\r\n      healthScores.filter((score) => score == 0).length,\r\n    ];\r\n\r\n    return {\r\n      // labels: ['Healthy', 'Warning', 'Critical', 'Undefined'],\r\n      datasets: [\r\n        {\r\n          data: healthScorePercentages,\r\n          backgroundColor: ['#64DD17', '#FFC107', '#FF5722', '#9E9E9E'],\r\n        },\r\n      ],\r\n      options: {\r\n        legend: {\r\n          display: false,\r\n        },\r\n      },\r\n    };\r\n  };\r\n\r\n\r\n  return (\r\n    <div className=\"cement-mill-sec\" >\r\n      <div className=\"cement-mill-wrapper\">\r\n        <div className=\"row\">\r\n          {prop.machine.map((machine, index) => (\r\n            \r\n            <div key={index} className=\"col-lg col-20 mb-1\">\r\n              <div style={{fontWeight:\"bold\"}}>{machine.name}</div>\r\n              \r\n             {board? <Pie data={getChartData(machine)} width={200}   height={200} options={{\r\n                maintainAspectRatio: false,\r\n                responsive: false,\r\n                \r\n                \r\n              }} />:<Pie data={getChartData2(machine)} width={200}   height={200} options={{\r\n                maintainAspectRatio: false,\r\n                responsive: false,\r\n                \r\n                \r\n              }} />}\r\n              <div>{\"Health Score: \"+machine.healthScore}<br/>{\"Status: \"+machine.status}<br/>{\"MG: \"+machine.mg}</div>\r\n              {/* {console.log(machine)} */}\r\n            </div>\r\n          ))}\r\n          {showPopup && (\r\n            <div\r\n              className=\"popup\"\r\n              id=\"exampleModal\"\r\n              tabIndex=\"-1\"\r\n              aria-labelledby=\"exampleModalLabel\"\r\n              aria-hidden=\"true\"\r\n            >\r\n              {/* ... Popup content ... */}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Machine;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}