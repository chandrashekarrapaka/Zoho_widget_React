{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{LoginCredentialsAndQueries}from\"../../../Services/loginCredentialsAndQueries\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function AA(prop){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),accessToken=_useState2[0],setAccessToken=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),dataDisplay=_useState4[0],setDataDisplay=_useState4[1];var currentPlant=prop.currentPlant;//console.log(\"AA1\", currentPlant[0].plantid, accessToken);\nuseEffect(function(){var fetchDataz=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return LoginCredentialsAndQueries();case 3:response=_context.sent;if(response.length>0){//console.log(\"responseAA\", response);\nsetAccessToken(response);}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function fetchDataz(){return _ref.apply(this,arguments);};}();fetchDataz();},[]);var plantid=currentPlant[0].plantid;useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var now,dtTo,dtFrom,response,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:now=new Date();dtTo=now.toISOString().replace(/\\.\\d+Z$/,\"Z\").replace(/:/g,\"%3A\");dtFrom=new Date(now.getTime()-48*60*60*1000).toISOString().replace(/\\.\\d+Z$/,\"Z\").replace(/:/g,\"%3A\");_context2.prev=3;_context2.next=6;return fetch(\"https://api.infinite-uptime.com/api/3.0/idap-api/anomaly-alerts/plants?plantIds=\"+plantid+\"&from=\"+dtFrom+\"&to=\"+dtTo,{method:\"GET\",headers:{accept:\"application/json\",Authorization:\"Bearer \"+accessToken}});case 6:response=_context2.sent;_context2.next=9;return response.json();case 9:data=_context2.sent;setDataDisplay(data);//console.log(\"alerts\", JSON.stringify(data.data.length));\n_context2.next=16;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](3);console.error(_context2.t0);case 16:case\"end\":return _context2.stop();}},_callee2,null,[[3,13]]);}));return function fetchData(){return _ref2.apply(this,arguments);};}();fetchData();var interval=setInterval(fetchData,30000);// Fetch data every 30 seconds\nreturn function(){clearInterval(interval);// Clean up the interval on component unmount\n};},[currentPlant,accessToken]);//console.log(\"data\"+JSON.stringify(dataDisplay));\nvar lengthofDisplay=dataDisplay&&dataDisplay.data.length==0;// console.log(\"checking\",lengthofDisplay,dataDisplay.data.length)\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"anomaly-alert\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"heading fs-16\",children:\"Anomaly Alert\"}),/*#__PURE__*/_jsx(\"div\",{className:\"data-box\",children:/*#__PURE__*/_jsx(\"div\",{class:\"data mb-2 fs-11\",children:dataDisplay&&dataDisplay.data.length>0?dataDisplay.data.map(function(ele){return/*#__PURE__*/_jsxs(\"div\",{className:\"content-itemz\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"fs-11 mb-0 text-dark\",children:[\"Machine Name:\",/*#__PURE__*/_jsxs(\"span\",{className:\"fw-bold\",children:[\" \",ele.machineName]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"data-badge fs-11 mb-0\",children:[\"Monitor Name: \",ele.monitorName]}),/*#__PURE__*/_jsxs(\"div\",{className:\"anomaly-magnitude fs-11\",children:[\"Anomaly Magnitude: \",ele.anomalyMagnitude]}),/*#__PURE__*/_jsxs(\"div\",{className:\"alert-timestamp fs-11\",children:[\"Alert Timestamp: \",ele.alertTimestamp]}),/*#__PURE__*/_jsxs(\"div\",{className:\"anomaly-detected fs-11\",children:[\"Anomaly Detected: \",ele.anomalyDetected]})]});}):{lengthofDisplay:lengthofDisplay}?/*#__PURE__*/_jsx(_Fragment,{children:\"No Anomaly Alert in Last 48 Hours\"}):/*#__PURE__*/_jsx(_Fragment,{children:\"No Anomaly Alert in Last 48 Hours\"})})})]});}export default AA;","map":{"version":3,"names":["React","useState","useEffect","LoginCredentialsAndQueries","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AA","prop","_useState","_useState2","_slicedToArray","accessToken","setAccessToken","_useState3","_useState4","dataDisplay","setDataDisplay","currentPlant","fetchDataz","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","sent","length","t0","console","error","stop","apply","arguments","plantid","fetchData","_ref2","_callee2","now","dtTo","dtFrom","data","_callee2$","_context2","Date","toISOString","replace","getTime","fetch","method","headers","accept","Authorization","json","interval","setInterval","clearInterval","lengthofDisplay","className","children","class","map","ele","machineName","monitorName","anomalyMagnitude","alertTimestamp","anomalyDetected"],"sources":["C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/src/Components/Containers/AA/AA.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { LoginCredentialsAndQueries } from \"../../../Services/loginCredentialsAndQueries\";\r\n\r\nfunction AA(prop) {\r\n  const [accessToken, setAccessToken] = useState(\"\");\r\n  const [dataDisplay, setDataDisplay] = useState();\r\n\r\n  const currentPlant = prop.currentPlant;\r\n  //console.log(\"AA1\", currentPlant[0].plantid, accessToken);\r\n\r\n  useEffect(() => {\r\n    const fetchDataz = async () => {\r\n      try {\r\n        const response = await LoginCredentialsAndQueries();\r\n        if (response.length > 0) {\r\n          //console.log(\"responseAA\", response);\r\n          setAccessToken(response);\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    };\r\n\r\n    fetchDataz();\r\n  }, []);\r\n\r\n  let plantid = currentPlant[0].plantid;\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      let now = new Date();\r\n      let dtTo = now.toISOString().replace(/\\.\\d+Z$/, \"Z\").replace(/:/g, \"%3A\");\r\n      let dtFrom = new Date(now.getTime() - 48 * 60 * 60 * 1000)\r\n        .toISOString()\r\n        .replace(/\\.\\d+Z$/, \"Z\")\r\n        .replace(/:/g, \"%3A\");\r\n\r\n      try {\r\n        const response = await fetch(\r\n          \"https://api.infinite-uptime.com/api/3.0/idap-api/anomaly-alerts/plants?plantIds=\" +\r\n          plantid +\r\n          \"&from=\" +\r\n          dtFrom +\r\n          \"&to=\" +\r\n          dtTo,\r\n          {\r\n            method: \"GET\",\r\n            headers: {\r\n              accept: \"application/json\",\r\n              Authorization: \"Bearer \" + accessToken,\r\n            },\r\n          }\r\n        );\r\n\r\n        const data = await response.json();\r\n        setDataDisplay(data);\r\n        //console.log(\"alerts\", JSON.stringify(data.data.length));\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n\r\n    const interval = setInterval(fetchData, 30000); // Fetch data every 30 seconds\r\n\r\n    return () => {\r\n      clearInterval(interval); // Clean up the interval on component unmount\r\n    };\r\n  }, [currentPlant, accessToken]);\r\n  //console.log(\"data\"+JSON.stringify(dataDisplay));\r\n  let lengthofDisplay = dataDisplay && dataDisplay.data.length == 0;\r\n  // console.log(\"checking\",lengthofDisplay,dataDisplay.data.length)\r\n  return (\r\n    <div className=\"anomaly-alert\">\r\n      <p className=\"heading fs-16\">Anomaly Alert</p>\r\n      <div className=\"data-box\">\r\n      <div class=\"data mb-2 fs-11\">\r\n        {dataDisplay && dataDisplay.data.length > 0 ? (\r\n          dataDisplay.data.map((ele) => (\r\n            <div className=\"content-itemz\">\r\n              <div className=\"fs-11 mb-0 text-dark\">Machine Name: \r\n             <span className=\"fw-bold\"> {ele.machineName}</span>\r\n              </div>\r\n              <div className=\"data-badge fs-11 mb-0\">Monitor Name: {ele.monitorName}</div>\r\n              <div className=\"anomaly-magnitude fs-11\">Anomaly Magnitude: {ele.anomalyMagnitude}</div>\r\n              <div className=\"alert-timestamp fs-11\">Alert Timestamp: {ele.alertTimestamp}</div>\r\n              <div className=\"anomaly-detected fs-11\">Anomaly Detected: {ele.anomalyDetected}</div>\r\n            </div>\r\n          ))\r\n        ) :\r\n          ({ lengthofDisplay } ? (<>No Anomaly Alert in Last 48 Hours</>) : (<>No Anomaly Alert in Last 48 Hours</>))}\r\n      </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AA;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}