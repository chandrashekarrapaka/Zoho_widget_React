{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _slicedToArray from\"C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";export function Plants(){return _Plants.apply(this,arguments);}function _Plants(){_Plants=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var accessToken,arrayOfPlants,arrayOfMachines,apicallstatus,loginResponse,queryParams,loginData,orgid,orgidAll,fetchPlantsData;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:accessToken=\"\";arrayOfPlants=[];arrayOfMachines=[];apicallstatus=true;_context3.prev=4;_context3.next=7;return window.ZOHO.CREATOR.init().then(function(data){var accessTokenz=\"\";var userid=window.ZOHO.CREATOR.UTIL.getQueryParams().user;var config={appName:\"infinite-control-room\",reportName:\"My_Profile_Data\",criteria:\"Username == \\\"\"+userid+\"\\\"\",page:\"1\",pageSize:\"100\"};var access=window.ZOHO.CREATOR.API.getAllRecords(config).then(function(response){var userData=response;accessTokenz=userData.data[0].Access_Token;return accessTokenz;});return access;});case 7:loginResponse=_context3.sent;_context3.next=10;return window.ZOHO.CREATOR.init().then(function(data){return window.ZOHO.CREATOR.UTIL.getQueryParams();});case 10:queryParams=_context3.sent;_context3.next=13;return loginResponse;case 13:loginData=_context3.sent;accessToken=loginData;orgid=queryParams.PlantId.split(\",\")[1];orgidAll=queryParams.PlantId.split(\",\");fetchPlantsData=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return Promise.all(orgidAll.map(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(orgid){var plantsResponse,plantsData,plantsArray;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://api.infinite-uptime.com/api/3.0/idap-api/plants/\".concat(orgid,\"/machine-group-stats\"),{method:'GET',headers:{'accept':'application/json','Authorization':'Bearer '+accessToken}});case 2:plantsResponse=_context.sent;if(!(plantsResponse.status===401)){_context.next=7;break;}apicallstatus=false;console.log(\"apicallstatus: \"+apicallstatus);return _context.abrupt(\"return\",([[]],apicallstatus));case 7:_context.next=9;return plantsResponse.json();case 9:plantsData=_context.sent;plantsArray=[];plantsData.data.machineGroups.forEach(function(mg){mg.machines.forEach(function(machine){machine.mg=mg.name;machine.plantName=plantsData.data.name;machine.plantid=plantsData.data.id;plantsArray.push(machine);});});arrayOfMachines.push(plantsArray);arrayOfPlants.push(plantsData.data);case 14:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref4.apply(this,arguments);};}()));case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);throw _context2.t0;case 8:case\"end\":return _context2.stop();}},_callee2,null,[[0,5]]);}));return function fetchPlantsData(){return _ref3.apply(this,arguments);};}();_context3.next=20;return fetchPlantsData();case 20:return _context3.abrupt(\"return\",[arrayOfMachines,apicallstatus]);case 23:_context3.prev=23;_context3.t0=_context3[\"catch\"](4);console.error(_context3.t0);throw _context3.t0;case 27:case\"end\":return _context3.stop();}},_callee3,null,[[4,23]]);}));return _Plants.apply(this,arguments);}Plants().then(function(_ref){var _ref2=_slicedToArray(_ref,2),machines=_ref2[0],status=_ref2[1];//console.log(\"Machines:\", machines);\nconsole.log(\"API Call Status:\",status);}).catch(function(error){console.log(\"Error:\",error);});","map":{"version":3,"names":["Plants","_Plants","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee3","accessToken","arrayOfPlants","arrayOfMachines","apicallstatus","loginResponse","queryParams","loginData","orgid","orgidAll","fetchPlantsData","wrap","_callee3$","_context3","prev","next","window","ZOHO","CREATOR","init","then","data","accessTokenz","userid","UTIL","getQueryParams","user","config","appName","reportName","criteria","page","pageSize","access","API","getAllRecords","response","userData","Access_Token","sent","PlantId","split","_ref3","_callee2","_callee2$","_context2","Promise","all","map","_ref4","_callee","plantsResponse","plantsData","plantsArray","_callee$","_context","fetch","concat","method","headers","status","console","log","abrupt","json","machineGroups","forEach","mg","machines","machine","name","plantName","plantid","id","push","stop","_x","t0","error","_ref","_ref2","_slicedToArray","catch"],"sources":["C:/Users/demo/Desktop/CRV/Zoho_widget_React/react_app/src/Services/Json.js"],"sourcesContent":["export async function Plants() {\r\n  let accessToken = \"\";\r\n  const arrayOfPlants = [];\r\n  const arrayOfMachines = [];\r\n  let apicallstatus = true;\r\n\r\n  try {\r\n    const loginResponse = await window.ZOHO.CREATOR.init().then(function (data) {\r\n      let accessTokenz = \"\";\r\n      let userid = window.ZOHO.CREATOR.UTIL.getQueryParams().user;\r\n\r\n      var config = {\r\n        appName: \"infinite-control-room\",\r\n        reportName: \"My_Profile_Data\",\r\n        criteria: \"Username == \\\"\" + userid + \"\\\"\",\r\n        page: \"1\",\r\n        pageSize: \"100\"\r\n      };\r\n\r\n      const access = window.ZOHO.CREATOR.API.getAllRecords(config).then(function (response) {\r\n        let userData = response;\r\n        accessTokenz = userData.data[0].Access_Token;\r\n        return accessTokenz;\r\n      });\r\n      \r\n      return access;\r\n    });\r\n\r\n    const queryParams = await window.ZOHO.CREATOR.init().then(function (data) {\r\n      return window.ZOHO.CREATOR.UTIL.getQueryParams();\r\n    });\r\n\r\n    const loginData = await loginResponse;\r\n    accessToken = loginData;\r\n\r\n    let orgid = queryParams.PlantId.split(\",\")[1];\r\n    const orgidAll = queryParams.PlantId.split(\",\");\r\n\r\n    const fetchPlantsData = async () => {\r\n      try {\r\n        await Promise.all(orgidAll.map(async (orgid) => {\r\n          const plantsResponse = await fetch(`https://api.infinite-uptime.com/api/3.0/idap-api/plants/${orgid}/machine-group-stats`, {\r\n            method: 'GET',\r\n            headers: {\r\n              'accept': 'application/json',\r\n              'Authorization': 'Bearer ' + accessToken,\r\n            },\r\n          });\r\n\r\n          if (plantsResponse.status === 401) {\r\n            apicallstatus = false;\r\n            console.log(\"apicallstatus: \" + apicallstatus);\r\n            return [[]],apicallstatus;\r\n          }\r\n          \r\n          const plantsData = await plantsResponse.json();\r\n          const plantsArray = [];\r\n          \r\n          plantsData.data.machineGroups.forEach((mg) => {\r\n            mg.machines.forEach((machine) => {\r\n              machine.mg = mg.name;\r\n              machine.plantName = plantsData.data.name;\r\n              machine.plantid = plantsData.data.id;\r\n              plantsArray.push(machine);\r\n            });\r\n          });\r\n\r\n          arrayOfMachines.push(plantsArray);\r\n          arrayOfPlants.push(plantsData.data);\r\n        }));\r\n      } catch (error) {\r\n        throw error;\r\n      }\r\n    };\r\n\r\n    await fetchPlantsData();\r\n\r\n    // The interval code has been removed.\r\n\r\n    return [arrayOfMachines, apicallstatus];\r\n\r\n  } catch (error) {\r\n    console.error(error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nPlants()\r\n  .then(([machines, status]) => {\r\n    //console.log(\"Machines:\", machines);\r\n    console.log(\"API Call Status:\", status);\r\n  })\r\n  .catch((error) => {\r\n    console.log(\"Error:\", error);\r\n  });\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}