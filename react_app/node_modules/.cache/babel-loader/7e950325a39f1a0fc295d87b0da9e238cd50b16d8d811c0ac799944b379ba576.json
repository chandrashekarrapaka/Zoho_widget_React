{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/DELL/Desktop/zoho-creator-widget-starter-template-reactJS/react_app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/DELL/Desktop/zoho-creator-widget-starter-template-reactJS/react_app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"C:/Users/DELL/Desktop/zoho-creator-widget-starter-template-reactJS/react_app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/DELL/Desktop/zoho-creator-widget-starter-template-reactJS/react_app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import\"./Header.css\";import KPI from\"./KPI\";import{Image}from\"../../Services/image\";import{LoginCredentialsAndQueries}from\"../../Services/loginCredentialsAndQueries\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Header(prop){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),imageUrl=_useState2[0],setImageUrl=_useState2[1];// Initialize with the initial kipobj value\n//console.log(\"kpimachines\"+prop.kpimachines)\nvar initialKipobj={// kpi1: {\n//   title: \"\",\n//   value: \"Total Devices Installed\",\n// },\n// kpi2: { title: \"\", value: \"Total Machines Digitized\" },\nkpi3:{title:\"3\",value:\"Total Faults Identified\"},kpi4:{title:\"4\",value:\"Reports Closed\"},kpi5:{title:\"5\",value:\"Downtime Saved (Hrs)\"}};var newobj={kpi1:{title:\"\",value:\"Total Devices Installed\"},kpi2:{title:\"\",value:\"Total Machines Digitized\"}};//console.log(\"kpimonitors\"+prop.kpimonitors,initialKipobj.kpi1.title)\nvar _useState3=useState(initialKipobj),_useState4=_slicedToArray(_useState3,2),kipobj=_useState4[0],setKipobj=_useState4[1];var _useState5=useState(newobj),_useState6=_slicedToArray(_useState5,2),kipobjnew=_useState6[0],setKipobjNew=_useState6[1];useEffect(function(){var timer=setTimeout(function(){console.log(\"working after\"+prop.kpimachines,prop.kpimachines);var new12=_objectSpread(_objectSpread({},kipobjnew),{},{kpi1:_objectSpread(_objectSpread({},kipobjnew.kpi1),{},{title:JSON.stringify(prop.kpimonitors)}),kpi2:_objectSpread(_objectSpread({},kipobjnew.kpi2),{},{title:JSON.stringify(prop.kpimachines)})});setKipobjNew(new12);},5000);return function(){return clearTimeout(timer);};},[prop.kpimachines,prop.kpimonitors]);useEffect(function(){var fetchDataz=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Image();case 3:response=_context.sent;if(response.length>0){console.log(\"imageurl\",response);setImageUrl(response);}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function fetchDataz(){return _ref.apply(this,arguments);};}();fetchDataz();},[]);useEffect(function(){var fetchPlantDetails=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var plantid,token,kpidatafinal,kpidata,updatedKipobj;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;plantid=prop.currentPlant[0].plantid;_context2.next=4;return LoginCredentialsAndQueries();case 4:token=_context2.sent;_context2.next=7;return fetch('https://api-idap.infinite-uptime.com/api/3.0/idap-api/service-requests/analytics?plantIds='+plantid,{method:'GET',headers:{'Authorization':'Bearer '+token,'accept':\"*/*\"}});case 7:kpidatafinal=_context2.sent;_context2.next=10;return kpidatafinal.json();case 10:kpidata=_context2.sent;console.log(\"downtime\"+JSON.stringify(kpidata.data[0]));updatedKipobj=_objectSpread(_objectSpread({},kipobj),{},{kpi4:_objectSpread(_objectSpread({},kipobj.kpi4),{},{title:JSON.stringify(kpidata.data[0].completedCount)}),kpi5:_objectSpread(_objectSpread({},kipobj.kpi5),{},{title:JSON.stringify(kpidata.data[0].downtime)}),// kpi2:{\n//   ...kipobj.kpi2,\n//   title:\n//   JSON.stringify(prop.kpimachines)\n// },\nkpi3:_objectSpread(_objectSpread({},kipobj.kpi3),{},{title:JSON.stringify(kpidata.data[0].newCount)})//totaldevicesinstalled\n// kpi1: {\n//   ...kipobj.kpi1,\n//   title:\n//   JSON.stringify(prop.kpimonitors)\n// }\n});setKipobj(updatedKipobj);_context2.next=19;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 19:case\"end\":return _context2.stop();}},_callee2,null,[[0,16]]);}));return function fetchPlantDetails(){return _ref2.apply(this,arguments);};}();fetchPlantDetails();},[prop.currentPlant,prop.kpimachines,prop.kpimonitors]);return/*#__PURE__*/_jsxs(\"div\",{className:\"kpis\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"kpiItems\",children:/*#__PURE__*/_jsx(\"img\",{src:imageUrl,alt:\"Plant\"})}),Object.keys(kipobjnew).map(function(ele){return/*#__PURE__*/_jsx(KPI,{data:kipobjnew[ele]});}),Object.keys(kipobj).map(function(ele){return/*#__PURE__*/_jsx(KPI,{data:kipobj[ele]});})]});}export default Header;","map":{"version":3,"names":["React","useState","useEffect","KPI","Image","LoginCredentialsAndQueries","jsx","_jsx","jsxs","_jsxs","Header","prop","_useState","_useState2","_slicedToArray","imageUrl","setImageUrl","initialKipobj","kpi3","title","value","kpi4","kpi5","newobj","kpi1","kpi2","_useState3","_useState4","kipobj","setKipobj","_useState5","_useState6","kipobjnew","setKipobjNew","timer","setTimeout","console","log","kpimachines","new12","_objectSpread","JSON","stringify","kpimonitors","clearTimeout","fetchDataz","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","sent","length","t0","error","stop","apply","arguments","fetchPlantDetails","_ref2","_callee2","plantid","token","kpidatafinal","kpidata","updatedKipobj","_callee2$","_context2","currentPlant","fetch","method","headers","json","data","completedCount","downtime","newCount","className","children","src","alt","Object","keys","map","ele"],"sources":["C:/Users/DELL/Desktop/zoho-creator-widget-starter-template-reactJS/react_app/src/Components/Header/Header.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport \"./Header.css\";\r\nimport KPI from \"./KPI\";\r\nimport { Image } from \"../../Services/image\";\r\nimport { LoginCredentialsAndQueries } from \"../../Services/loginCredentialsAndQueries\";\r\n\r\n\r\n  \r\nfunction Header(prop) {\r\n  const [imageUrl, setImageUrl] = useState(\"\");\r\n   // Initialize with the initial kipobj value\r\n  //console.log(\"kpimachines\"+prop.kpimachines)\r\n  const initialKipobj = {\r\n    // kpi1: {\r\n    //   title: \"\",\r\n    //   value: \"Total Devices Installed\",\r\n    // },\r\n    // kpi2: { title: \"\", value: \"Total Machines Digitized\" },\r\n    kpi3: { title: \"3\", value: \"Total Faults Identified\" },\r\n    kpi4: { title: \"4\", value: \"Reports Closed\" },\r\n    kpi5: { title: \"5\", value: \"Downtime Saved (Hrs)\" },\r\n  };\r\n  const newobj={\r\n  kpi1: {\r\n      title: \"\",\r\n      value: \"Total Devices Installed\",\r\n    },\r\n    kpi2: { title: \"\", value: \"Total Machines Digitized\" }\r\n  }\r\n  //console.log(\"kpimonitors\"+prop.kpimonitors,initialKipobj.kpi1.title)\r\n  const [kipobj, setKipobj] = useState(initialKipobj);\r\n  const [kipobjnew,setKipobjNew]=useState(newobj)\r\n  \r\nuseEffect(()=>{\r\n  const timer=setTimeout(()=>{\r\n    console.log(\"working after\"+prop.kpimachines,prop.kpimachines);\r\n    \r\n    const new12={...kipobjnew,\r\n      kpi1: {\r\n        ...kipobjnew.kpi1,\r\n        title: JSON.stringify(prop.kpimonitors),\r\n      },\r\n      kpi2: {\r\n        ...kipobjnew.kpi2,\r\n        title: JSON.stringify(prop.kpimachines),\r\n      }\r\n    }\r\n      setKipobjNew(new12)\r\n  \r\n\r\n  \r\n},5000)\r\n  return () => clearTimeout(timer);\r\n},[prop.kpimachines,prop.kpimonitors]);\r\n\r\n  useEffect(() => {\r\n    const fetchDataz = async () => {\r\n      try {\r\n        const response = await Image();\r\n        if (response.length > 0) {\r\n          console.log(\"imageurl\", response);\r\n          setImageUrl(response);\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    };\r\n\r\n    fetchDataz();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const fetchPlantDetails = async () => {\r\n      try {\r\n        let plantid = prop.currentPlant[0].plantid;\r\n        let token=await LoginCredentialsAndQueries();\r\n        \r\n         const kpidatafinal= await fetch('https://api-idap.infinite-uptime.com/api/3.0/idap-api/service-requests/analytics?plantIds='+plantid,{\r\n            method: 'GET',\r\n            headers:{\r\n              'Authorization':'Bearer '+ token,\r\n              'accept': \"*/*\",\r\n            },\r\n\r\n          });\r\n        let  kpidata = await kpidatafinal.json();\r\n        console.log(\"downtime\"+JSON.stringify(kpidata.data[0]));\r\n        \r\n        \r\n\r\n        const updatedKipobj = {\r\n          ...kipobj,\r\n          kpi4: {\r\n            ...kipobj.kpi4,\r\n            title: JSON.stringify(kpidata.data[0].completedCount),\r\n          },\r\n          kpi5: {\r\n            ...kipobj.kpi5,\r\n            title:JSON.stringify(kpidata.data[0].downtime),\r\n          },\r\n          // kpi2:{\r\n          //   ...kipobj.kpi2,\r\n          //   title:\r\n          //   JSON.stringify(prop.kpimachines)\r\n          // },\r\n          kpi3: {\r\n            ...kipobj.kpi3,\r\n            title:\r\n            JSON.stringify(kpidata.data[0].newCount)\r\n          },\r\n         //totaldevicesinstalled\r\n          // kpi1: {\r\n          //   ...kipobj.kpi1,\r\n          //   title:\r\n          //   JSON.stringify(prop.kpimonitors)\r\n          // }\r\n        };\r\n        \r\n       setKipobj(updatedKipobj);\r\n        \r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    };\r\n\r\n    fetchPlantDetails();\r\n  }, [prop.currentPlant,prop.kpimachines,prop.kpimonitors ]);\r\n\r\n  return (\r\n    <div className=\"kpis\">\r\n      <div className=\"kpiItems\"><img src={imageUrl} alt=\"Plant\" /></div>\r\n      {Object.keys(kipobjnew).map(function (ele) {\r\n        return <KPI data={kipobjnew[ele]} />;\r\n      })}\r\n      {Object.keys(kipobj).map(function (ele) {\r\n        return <KPI data={kipobj[ele]} />;\r\n      })}\r\n      \r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Header;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}